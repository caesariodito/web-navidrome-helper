version: "3.9"

services:
  nd-import-helper:
    build: .
    image: nd-import-helper:latest
    ports:
      - "${PORT:-5000}:5000"
    env_file:
      - .env
    environment:
      NODE_ENV: production
      NAVIDROME_MUSIC_PATH: /data/navidrome/music
      ND_IMPORT_BIN: /usr/local/bin/nd-import
    volumes:
      - "${HOST_NAVIDROME_MUSIC_PATH:?Set HOST_NAVIDROME_MUSIC_PATH in .env}:/data/navidrome/music:rw"
      - "${HOST_ND_IMPORT_BIN:?Set HOST_ND_IMPORT_BIN in .env}:/usr/local/bin/nd-import:ro"
    restart: unless-stopped
